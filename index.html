<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Alma's Music</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    /* Paleta pastel, estilo limpio */
    --bg:#f9fafb; --grid:#f0f2f5; --ink:#3b3b45; --muted:#7b7f8c;
    --deck:#f6eefe; --deck-2:#e8def7; --plinth:#f3f7ff; --platter:#e8eef7;
    --accent:#9a8cff; --mint:#8dd7c2; --rose:#ffb3c1; --lemon:#ffe59a;
    --shadow:0 10px 30px rgba(35,38,50,.12); --radius:18px;
  }
  *{box-sizing:border-box} html,body{height:100%}
  body{
    margin:0; font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:var(--ink);
    background:
      linear-gradient(0deg, transparent 24%, var(--grid) 25%, var(--grid) 26%, transparent 27%),
      linear-gradient(90deg, transparent 24%, var(--grid) 25%, var(--grid) 26%, transparent 27%),
      var(--bg);
    background-size:36px 36px;
  }
  header{position:sticky; top:0; z-index:20; backdrop-filter: blur(8px);
    background:color-mix(in oklab, #fff 70%, var(--deck) 30%); border-bottom:1px solid #e7e9ef}
  .nav{max-width:1100px; padding:14px 4%; margin:auto; display:flex; justify-content:space-between; align-items:center; gap:12px}
  .brand{font-weight:800; letter-spacing:.2px} .brand small{font-weight:600; color:var(--muted)}
  .container{max-width:1100px; margin:20px auto 60px; padding:0 4%}

  /* ---- Tocadiscos ---- */
  .deck{width:min(920px,100%); margin:18px auto; background:linear-gradient(180deg,var(--deck),var(--deck-2));
    border:2px solid color-mix(in oklab,var(--deck-2) 70%, #000 10%); border-radius:var(--radius); box-shadow:var(--shadow); padding:18px; position:relative}
  .base{background:var(--plinth); border:2px solid #e8eaf5; border-radius:14px; padding:20px; display:grid; grid-template-columns: 1.2fr .8fr; gap:20px}
  @media (max-width:900px){ .base{grid-template-columns:1fr} }

  .platter{aspect-ratio:1; width:min(520px,100%); margin:auto; border-radius:50%;
    background:
      radial-gradient(circle at 50% 50%, #d7deea 0 42%, #cfd7e6 42% 44%, #dfe6f2 44%);
    border:10px solid var(--platter); box-shadow:inset 0 10px 20px rgba(0,0,0,.05);
    position:relative; display:grid; place-items:center}
  .record{--rev:1.8s; position:relative; width:88%; aspect-ratio:1; border-radius:50%;
    background:radial-gradient(circle at 50% 50%, #1f232e 0 72%, #121521 72% 100%);
    box-shadow:inset 0 0 0 10px #1b1f29, inset 0 0 0 40px #0f121a;
    animation:spin var(--rev) linear infinite; animation-play-state:paused}
  .record::after{content:""; position:absolute; inset:0; margin:auto; width:34%; aspect-ratio:1; border-radius:50%;
    background:var(--label, radial-gradient(circle at 30% 30%, #ffd6e7, #c9baff));
    box-shadow:0 8px 14px rgba(0,0,0,.12), inset 0 0 0 6px rgba(255,255,255,.6)}
  @keyframes spin{to{ transform:rotate(360deg) }}

  .arm{position:absolute; right:18px; top:24px; width:220px; height:22px; transform-origin: 200px 10px; transform: rotate(-28deg);
    transition: transform .8s cubic-bezier(.2,.7,.1,1); pointer-events:none}
  .arm .rod{position:absolute; left:0; top:0; width:200px; height:6px; border-radius:6px; background:linear-gradient(180deg,#e6e0f7,#cac0ee); box-shadow:inset 0 2px 0 rgba(255,255,255,.5)}
  .arm .head{position:absolute; right:-6px; top:-2px; width:24px; height:18px; border-radius:8px; background:linear-gradient(180deg,#2d3342,#1c2130); border:2px solid #121726}
  .arm .pivot{position:absolute; left:186px; top:-8px; width:22px; height:22px; border-radius:50%; background:#d9d2f3; border:2px solid #bfb6e8}
  .arm.playing{ transform: rotate(-10deg) }

  .controls{display:grid; grid-template-columns: 1fr; gap:14px}
  .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
  .btn{appearance:none; border:0; cursor:pointer; background:var(--rose); color:#432; padding:10px 14px; border-radius:999px; font-weight:700; box-shadow:var(--shadow)}
  .btn.secondary{ background:var(--lemon) } .btn.ghost{ background:transparent; outline:2px dashed #c9cde2; color:var(--ink) }
  .switch{position:relative; width:56px; height:30px; background:#e5e8f6; border-radius:999px; border:2px solid #cfd6ee; cursor:pointer}
  .switch i{position:absolute; top:2px; left:2px; width:24px; height:24px; border-radius:50%; background:var(--mint); transition:left .2s ease; box-shadow:0 2px 0 rgba(255,255,255,.6) inset, var(--shadow)}
  .switch[data-on="true"] i{ left:30px }
  .lamp{width:10px; height:10px; background:#b9bfd6; border-radius:50%; box-shadow:0 0 0 2px #dfe4f5 inset}
  .lamp.on{ background:var(--mint); box-shadow:0 0 8px var(--mint) }
  .speed{display:flex; gap:8px; align-items:center; background:#f1f3fb; border:2px solid #dfe4f5; padding:6px 10px; border-radius:10px}
  .speed input{ accent-color: var(--accent) }
  .progress{width:100%; height:10px; border-radius:999px; background:#e7ebf7; position:relative; overflow:hidden; border:2px solid #dfe4f5; cursor:pointer}
  .bar{position:absolute; left:0; top:0; bottom:0; width:0%; background:linear-gradient(90deg,var(--accent),#8dd7c2)}
  .timers{display:flex; justify-content:space-between; color:var(--muted); font-size:12px}

  .section-title{margin:20px 0 10px; font-weight:700}
  .grid{display:grid; gap:14px; grid-template-columns: repeat(auto-fill,minmax(180px,1fr))}
  .card{background:#fff; border:1px solid #e7e9ef; border-radius:14px; padding:10px; box-shadow:var(--shadow); display:grid; gap:8px; cursor:pointer}
  .thumb{ aspect-ratio:1; border-radius:10px; background:#f4f6fb center/cover no-repeat; border:1px solid #e5e8f3 }
  .meta{ font-size:12px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
  .title{ font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }

  :focus-visible{ outline:3px solid color-mix(in oklab, var(--accent) 70%, #fff 30%); outline-offset:3px }
</style>
</head>
<body>
<header>
  <nav class="nav">
    <div class="brand">Alma's Music <small>English Version</small></div>
    <div class="row">
      <div class="lamp" id="lamp"></div>
      <div class="switch" id="power" role="switch" aria-checked="false" aria-label="Power"><i></i></div>
    </div>
  </nav>
</header>

<main class="container">
  <!-- Tocadiscos -->
  <section class="deck" aria-label="Tocadiscos">
    <div class="base">
      <!-- Plato -->
      <div style="position:relative;display:grid;place-items:center">
        <div class="platter">
          <!-- üö´ Sin spindle -->
          <div class="record" id="record"></div>
          <div class="arm" id="arm"><span class="rod"></span><span class="pivot"></span><span class="head"></span></div>
        </div>
      </div>

      <!-- Controles -->
      <div class="controls">
        <div class="row">
          <button class="btn" id="play">‚ñ∂Ô∏é/‚è∏</button>
          <button class="btn secondary" id="stop">‚èπ</button>
          <button class="btn ghost" id="prev">‚èÆ</button>
          <button class="btn ghost" id="next">‚è≠</button>
        </div>

        <div class="speed" role="group" aria-label="Velocidad">
          <strong>RPM</strong>
          <label><input type="radio" name="rpm" value="33" checked> 33</label>
          <label><input type="radio" name="rpm" value="45"> 45</label>
        </div>

        <div class="row" style="align-items:center">
          <input id="volume" type="range" min="0" max="100" value="75" style="flex:1" aria-label="Volumen">
          <span style="width:46px;text-align:right" id="volText">75%</span>
        </div>

        <div class="progress" id="progress" aria-label="Progreso"><div class="bar" id="bar"></div></div>
        <div class="timers"><span id="tCur">0:00</span><span id="tDur">0:00</span></div>

        <div style="font-size:14px;color:var(--muted)">
          <div id="nowTitle" class="title">Sin vinilo</div>
          <div id="nowArtist" class="meta"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Biblioteca / VINILOS PRECARGADOS -->
  <h3 class="section-title">Vinilos</h3>
  <section class="grid" id="grid"></section>
</main>

<audio id="audio" preload="metadata" crossorigin="anonymous"></audio>

<script>

const LIBRARY = [
  { title: "In Your Love",   artist: "Tyler Childers",  cover: "In Your Love.jpg", audio: "In Your Love.mp3" },
  { title: "Line Without a Hook",         artist: "Ricky Montgomery",  cover: "Line Without a Hook.jpg", audio: "Line Without a Hook.mp3" },
  { title: "Dream Girl",         artist: "Crisaunt",         cover: "Dream Girl.avif", audio: "Dream Girl.mp3" },
  { title: "My Kind of Woman",           artist: "Mac DeMarco",      cover: "My Kind Of Woman.jpeg", audio: "My Kind Of Woman.mp3" },
  { title: "Dreamers",      artist: "Myles Smith",   cover: "Dreamers.jpeg", audio: "Dreamers.mp3" },
  { title: "Falling Like The Stars",          artist: "James Arthur",   cover: "Falling Like The Stars.jpeg", audio: "Falling Like The Stars.mp3" },
  { title: "Gone, Gone, Gone",           artist: "Phillip Phillips", cover: "Gone gone gone.jpeg", audio: "Gone gone gone.mp3" },
  { title: "Angel",           artist: "Jack Johnson",         cover: "Angel.jpeg", audio: "Angel.mp3" },
  { title: "Wait",        artist: "NoMBe",       cover: "wait.jpeg", audio: "wait.mp3" },
  { title: "Marry Me",         artist: "Train",  cover: "Marry Me.jpeg", audio: "Marry Me.mp3" }
];
/* ========================================================= */

const state = { on:false, rpm:33, volume:0.75, playing:false, list:[], current:-1 };
const $ = (s,ctx=document)=>ctx.querySelector(s);
const $$ = (s,ctx=document)=>[...ctx.querySelectorAll(s)];
const fmt = (t)=>{ if(!t||!isFinite(t)) return '0:00'; const m=Math.floor(t/60), s=Math.floor(t%60).toString().padStart(2,'0'); return `${m}:${s}`; };

const power=$('#power'), lamp=$('#lamp'), record=$('#record'), arm=$('#arm'), audio=$('#audio');
const playBtn=$('#play'), stopBtn=$('#stop'), prevBtn=$('#prev'), nextBtn=$('#next');
const rpmRadios=$$('input[name="rpm"]'); const vol=$('#volume'), volText=$('#volText');
const bar=$('#bar'), progress=$('#progress'), tCur=$('#tCur'), tDur=$('#tDur');
const nowTitle=$('#nowTitle'), nowArtist=$('#nowArtist'); const grid=$('#grid');

power.addEventListener('click', ()=>togglePower(!state.on));
power.addEventListener('keydown', e=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); togglePower(!state.on);} });
function togglePower(on){ state.on=on; power.dataset.on=on?'true':'false'; power.setAttribute('aria-checked', String(on)); lamp.classList.toggle('on', on); if(!on) stopAll(); }

function loadLibrary(){
  state.list = LIBRARY.map((v,i)=>({id:i+1, ...v, duration:0}));
  renderLibrary();
  state.list.forEach((v)=>getDuration(v.audio).then(d=>{v.duration=d; if(state.current===-1){ selectVinyl(0,false); }}).catch(()=>{}));
}
function renderLibrary(){
  grid.innerHTML='';
  state.list.forEach((v,i)=>{
    const card=document.createElement('article'); card.className='card'; card.tabIndex=0; card.setAttribute('role','button');
    const th=document.createElement('div'); th.className='thumb'; if(v.cover) th.style.backgroundImage=`url("${v.cover}")`;
    const ti=document.createElement('div'); ti.className='title'; ti.textContent=v.title;
    const me=document.createElement('div'); me.className='meta'; me.textContent=`${v.artist||'‚Äî'}`;
    card.append(th,ti,me);
    card.addEventListener('click',()=>selectVinyl(i,true));
    card.addEventListener('keydown',e=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); selectVinyl(i,true); }});
    grid.appendChild(card);
  });
}
function selectVinyl(index, autoPlay){
  if(index<0||index>=state.list.length) return;
  state.current=index; const v=state.list[index];
  record.style.setProperty('--label', v.cover ? `url("${v.cover}") center/cover no-repeat` : '');
  audio.src=v.audio; audio.playbackRate = state.rpm===45 ? (45/33.333) : 1;
  nowTitle.textContent=v.title; nowArtist.textContent=v.artist||''; tCur.textContent='0:00'; tDur.textContent=v.duration?fmt(v.duration):'0:00';
  if(state.on && autoPlay) play();
}

playBtn.addEventListener('click', ()=>state.playing?pause():play());
stopBtn.addEventListener('click', stopAll);
prevBtn.addEventListener('click', ()=>selectVinyl(prevIndex(), true));
nextBtn.addEventListener('click', ()=>selectVinyl(nextIndex(), true));
function prevIndex(){ return (state.current<=0 ? state.list.length-1 : state.current-1); }
function nextIndex(){ return (state.current+1) % state.list.length; }

function play(){
  if(!state.on){ togglePower(true); }
  if(state.current===-1 && state.list.length) selectVinyl(0,false);
  if(!audio.src) return;
  audio.play().then(()=>{ state.playing=true; record.style.animationPlayState='running'; arm.classList.add('playing'); }).catch(()=>{});
}
function pause(){ state.playing=false; audio.pause(); record.style.animationPlayState='paused'; arm.classList.remove('playing'); }
function stopAll(){ pause(); audio.currentTime=0; updateProgress(0,audio.duration||0); }

rpmRadios.forEach(r=>r.addEventListener('change', ()=>{
  state.rpm = Number(document.querySelector('input[name="rpm"]:checked').value);
  record.style.setProperty('--rev', state.rpm===45 ? '1.333s' : '1.8s');
  audio.playbackRate = state.rpm===45 ? (45/33.333) : 1;
}));

vol.addEventListener('input', ()=>{ state.volume=vol.valueAsNumber/100; audio.volume=state.volume; volText.textContent=Math.round(state.volume*100)+'%'; });
audio.volume=state.volume;

audio.addEventListener('timeupdate', ()=>{
  updateProgress(audio.currentTime, audio.duration);
  const start=-28, end=-6; const p=Math.min(1,(audio.currentTime||0)/Math.max(1,audio.duration||1));
  arm.style.transform=`rotate(${start+(end-start)*p}deg)`;
});
audio.addEventListener('loadedmetadata', ()=> tDur.textContent=fmt(audio.duration));
audio.addEventListener('ended', ()=> nextBtn.click());

progress.addEventListener('click', (e)=>{
  if(!audio.duration) return;
  const r=progress.getBoundingClientRect(); const p=(e.clientX-r.left)/r.width; audio.currentTime=audio.duration*p;
});
function updateProgress(cur,dur){ const p=dur?(cur/dur)*100:0; bar.style.width=`${p}%`; tCur.textContent=fmt(cur); tDur.textContent=fmt(dur); }

function getDuration(url){ return new Promise((res,rej)=>{ const a=new Audio(); a.preload='metadata'; a.src=url; a.addEventListener('loadedmetadata',()=>res(a.duration)); a.addEventListener('error',rej); }); }

/* Accesos r√°pidos */
document.addEventListener('keydown', (e)=>{
  if(['INPUT','TEXTAREA'].includes(e.target.tagName)) return;
  if(e.key===' '){ e.preventDefault(); playBtn.click(); }
  if(e.key==='ArrowRight') nextBtn.click();
  if(e.key==='ArrowLeft') prevBtn.click();
  if(e.key==='ArrowUp'){ vol.value=Math.min(100,vol.valueAsNumber+5); vol.dispatchEvent(new Event('input')); }
  if(e.key==='ArrowDown'){ vol.value=Math.max(0,vol.valueAsNumber-5); vol.dispatchEvent(new Event('input')); }
});

/* Init */
togglePower(false);
record.style.setProperty('--rev','1.8s');
loadLibrary();
</script>
</body>
</html>

